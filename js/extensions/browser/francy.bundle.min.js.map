{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 9652544aee77ac0126a1","webpack:///./src/render/renderer.js","webpack:///./src/util/data-decorator.js","webpack:///./src/util/initialize-decorator.js","webpack:///./src/util/component.js","webpack:///./src/render/chart.js","webpack:///./src/render/composite.js","webpack:///./src/render/base.js","webpack:///./src/util/logger.js","webpack:///./src/render/graph.js","webpack:///./src/render/menu.js","webpack:///./src/render/callback.js","webpack:///./src/render/modal.js","webpack:///./src/render/tooltip.js","webpack:///./src/francy.js","webpack:///./src/render/frame.js","webpack:///./src/util/json-utils.js","webpack:///./src/render/canvas.js","webpack:///./src/render/graph-factory.js","webpack:///./src/render/graph-tree.js","webpack:///./src/render/menu-context.js","webpack:///./src/render/modal-required.js","webpack:///./src/render/graph-generic.js","webpack:///./src/render/chart-factory.js","webpack:///./src/render/chart-bar.js","webpack:///./src/render/chart-line.js","webpack:///./src/render/chart-scatter.js","webpack:///./src/render/menu-main.js","webpack:///./src/render/modal-about.js","webpack:///./node_modules/save-svg-as-png/saveSvgAsPng.js","webpack:///./src/render/message.js"],"names":["Renderer","verbose","appendTo","callbackHandler","new","target","TypeError","render","undefined","unrender","logger","debug","element","transitionDuration","options","node","tagName","toLowerCase","d3","select","parentNode","top","right","bottom","left","width","parent","attr","getBoundingClientRect","margin","height","requires","props","decorator","name","descriptor","oldValue","value","hasData","getProperty","data","apply","arguments","obj","propertyPath","tmp","properties","split","property","hasOwnProperty","Array","length","Object","values","initialize","key","_initialize","RegisterMathJax","RegisterJupyterKeyboardEvents","syntaxHighlight","setTimeout","MathJax","Hub","Config","tex2jax","jax","inlineMath","displayMath","processEscapes","Register","StartupHook","selectAll","each","self","mathJax","append","remove","Queue","Configured","e","info","classes","map","cl","Jupyter","keyboard_manager","register_events","json","replace","match","cls","test","Chart","axis","yScale","xScale","datasets","datasetNames","tooltip","canvas","chart","keys","scaleLinear","range","domain","x","y","allValues","forEach","concat","max","d","xAxisGroup","call","axisBottom","style","text","title","yAxisGroup","axisLeft","showLegend","legendGroup","legend","slice","exit","enter","i","merge","colors","dataset","from","_","scaleSequential","interpolator","interpolateRainbow","Composite","renderers","renderer","push","settings","load","Base","log","Error","partial","parse","Logger","console","message","_format","error","level","Date","toISOString","Graph","contextMenu","callback","on","executeCallback","messages","event","callbacks","cb","trigger","execute","type","symbolCross","symbolDiamond","symbolSquare","symbolTriangle","symbolStar","symbolWye","symbolCircle","Menu","menusIterator","hasNext","menuItem","next","entry","action","html","menus","content","subMenusIterator","iterator","traverse","array","nextIndex","CallbackHandler","requiredArgs","callbackObj","_execute","calbackObj","JSON","stringify","Modal","overlay","holder","Tooltip","HTMLParent","pos","mouse","SVGParent","table","row","ALL_CANVAS","Francy","frame","id","exports","window","oldResize","onresize","zoomToFit","Frame","menu","add","frameId","renderChildren","JsonUtils","input","jsonRegex","exec","mime","MIME","Canvas","graph","chartFactory","zoom","updateZoom","translateX","translateY","scale","transform","zoomIdentity","translate","zoomed","stopped","defaultPrevented","stopPropagation","bounds","getBBox","clientBounds","fullWidth","fullHeight","midX","midY","Math","transition","duration","canvasId","TreeGraph","root","hierarchy","treeData","children","x0","y0","levelWidth","childCount","n","newHeight","treemap","tree","size","collapsed","collapse","update","_children","source","nodes","descendants","links","depth","linkGroup","link","linkEnter","o","diagonal","s","nodeGroup","nodeEnter","symbol","getSymbol","bound","nodeUpdate","layer","_applyEvents","nodeOnClick","click","canvasNodes","dataMap","reduce","ContextMenu","preventDefault","RequiredArgsModal","modalId","form","header","headerTitle","arg","onchange","checked","footer","checkValidity","inputElement","focus","GenericGraph","simulationActive","simulation","canvasLinks","linksToAdd","_filterNewElements","nodesToAdd","highlight","drag","dragstarted","dragged","dragended","empty","showNeighbours","connectedNodes","centerForce","forceCenter","manyForce","forceManyBody","strength","linkForce","forceLink","distance","collideForce","forceCollide","radius","iterations","forceX","forceY","forceSimulation","force","ticked","alpha","restart","toggle","linkedByIndex","index","neighboring","a","b","__data__","active","alphaTarget","fx","fy","canvasObjects","d3Element","newElements","find","ChartFactory","BarChart","scaleBand","padding","domainRange","barsGroup","bar","barEnter","bandwidth","_renderAxis","_renderLegend","LineChart","linesGroup","valueLine","line","lineEnter","ScatterChart","scatterGroup","scatter","scatterEnter","SvgToPng","MainMenu","aboutModal","menuId","saveSvgAsPng","AboutModal","version","out$","doctype","isElement","HTMLElement","SVGElement","requireDomNode","el","isExternal","url","lastIndexOf","location","host","inlineImages","images","querySelectorAll","checkDone","image","href","getAttributeNS","warn","document","createElement","ctx","getContext","img","Image","crossOrigin","getAttribute","src","onload","drawImage","setAttributeNS","toDataURL","onerror","styles","cssLoadedCallback","selectorRemap","modifyStyle","css","fontsQueue","sheets","styleSheets","rules","cssRules","j","rule","selectorText","err","querySelector","selector","cssText","fontUrlRegexp","fontUrlMatch","externalFontUrl","fontUrlIsDataURI","startsWith","format","getFontMimeTypeFromUrl","processFontQueue","fontUrl","supportedFormats","extensions","extension","indexOf","queue","font","pop","processNext","oReq","XMLHttpRequest","addEventListener","fontLoaded","transferFailed","open","responseType","send","fontBits","response","fontInBase64","arrayBufferToBase64","updateFontStyle","dataUrl","buffer","binary","bytes","Uint8Array","len","byteLength","String","fromCharCode","btoa","getDimension","clone","dim","v","viewBox","baseVal","parseInt","getComputedStyle","getPropertyValue","isNaN","parseFloat","reEncode","encodeURIComponent","p1","c","decodeURIComponent","prepareSvg","responsive","xmlns","outer","cloneNode","box","setAttribute","svg","createElementNS","appendChild","removeAttribute","join","fos","innerHTML","defs","insertBefore","firstChild","outHtml","svgAsDataUri","uri","svgAsPngUri","encoderType","encoderOptions","convertToPng","w","h","context","canvg","backgroundColor","globalCompositeOperation","fillStyle","fillRect","png","SecurityError","atob","download","navigator","msSaveOrOpenBlob","uriToBlob","saveLink","downloadSupported","display","body","blob","URL","createObjectURL","onclick","requestAnimationFrame","revokeObjectURL","removeChild","byteString","mimeString","ArrayBuffer","intArray","charCodeAt","Blob","saveSvg","define","Message","alertsId","messageEnter"],"mappings":"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","file":"francy.bundle.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9652544aee77ac0126a1","import Base from './base';\n\n/* global d3 */\n\nexport default class Renderer extends Base {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    if (new.target === Renderer) {\n      throw new TypeError('Cannot construct [Renderer] instances directly!');\n    }\n    if (this.render === undefined || typeof this.render !== 'function') {\n      throw new TypeError('Must override [render()] method!');\n    }\n    if (this.unrender === undefined) {\n      this.logger.debug('No [unrender()] method specified...');\n    }\n    this.element = undefined;\n    this.transitionDuration = 750; //ms\n  }\n  \n  _initialize() {}\n\n  get HTMLParent() {\n    return this.options.appendTo.element.node().tagName.toLowerCase() === 'svg' ? d3.select(this.options.appendTo.element.node().parentNode) : this.options.appendTo.element;\n  }\n\n  get SVGParent() {\n    return this.options.appendTo.element.node().tagName.toLowerCase() === 'div' ? this.options.appendTo.element.select('svg') : this.options.appendTo.element;\n  }\n  \n  get parent() {\n    return this.options.appendTo.element;\n  }\n  \n  get margin() {\n    return { top: 50, right: 50, bottom: 50, left: 50 };\n  }\n  \n  get width() {\n    let width = +this.parent.attr('width') || d3.select('body').node().getBoundingClientRect().width;\n    return width - this.margin.left - this.margin.right;\n  }\n  \n  get height() {\n    let height = +this.parent.attr('height') || d3.select('body').node().getBoundingClientRect().height;\n    return height - this.margin.top - this.margin.bottom;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/renderer.js","export function requires(props) {\n  return function decorator(target, name, descriptor) {\n    var oldValue = descriptor.value;\n\n    descriptor.value = function() {\n      if (!hasData(getProperty(this.data, props))) {\n        this.logger.debug(`No data here [${props}], nothing to render... continuing...`);\n        return;\n      }\n      return oldValue.apply(this, arguments);\n    };\n\n    return descriptor;\n  };\n}\n\nfunction getProperty(obj, propertyPath) {\n\n  var tmp = obj;\n\n  if (tmp && propertyPath) {\n    var properties = propertyPath.split('.');\n\n    for (var property of properties) {\n      if (!tmp.hasOwnProperty(property)) {\n        tmp = undefined;\n        break;\n      }\n      else {\n        tmp = tmp[property];\n      }\n    }\n  }\n\n  return tmp;\n}\n\nfunction hasData(obj) {\n  return obj && ((obj instanceof Array && obj.length) || (obj instanceof Object && Object.values(obj).length));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/data-decorator.js","export function initialize() {\n  return function (target, key, descriptor) {\n    var oldValue = descriptor.value;\n\n    descriptor.value = function() {\n      this._initialize();\n      return oldValue.apply(this, arguments);\n    };\n    return descriptor;\n  };\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/initialize-decorator.js","import Logger from './logger';\n\n/* global Jupyter, MathJax, d3 */\n\nexport function RegisterMathJax(element) {\n  if (!element) return;\n  setTimeout(() => {\n    try {\n      MathJax.Hub.Config({\n        tex2jax: {\n          jax: ['input/TeX', 'output/SVG'],\n          inlineMath: [\n            ['$', '$'],\n            ['\\\\(', '\\\\)']\n          ],\n          displayMath: [\n            ['$$', '$$'],\n            ['\\\\[', '\\\\]']\n          ],\n          processEscapes: true\n        }\n      });\n\n      MathJax.Hub.Register.StartupHook('End', function() {\n        setTimeout(() => {\n          element.selectAll('.francy-label').each(function() {\n            var self = d3.select(this),\n              mathJax = self.select('text>span>svg');\n            if (mathJax.node()) {\n              setTimeout(() => {\n                mathJax.attr('x', self.attr('x'));\n                mathJax.attr('y', -15);\n                d3.select(self.node().parentNode).append(function() {\n                  return mathJax.node();\n                });\n                self.selectAll('*').remove();\n              }, 10);\n            }\n          });\n        }, 250);\n      });\n\n      MathJax.Hub.Queue(['Typeset', MathJax.Hub, element.node()]);\n\n      MathJax.Hub.Configured();\n    }\n    catch (e) {\n      if (e.name === 'ReferenceError') {\n        new Logger().info('It seems MathJax is not loaded...', e);\n      }\n    }\n\n  }, 10);\n}\n\nexport function RegisterJupyterKeyboardEvents(classes) {\n  // disable keyboard shortcuts in Jupyter for classes\n  if (!classes) return;\n  try {\n    classes.map((cl) => {\n      Jupyter.keyboard_manager.register_events(cl);\n    });\n  }\n  catch (e) {\n    if (e.name === 'ReferenceError') {\n      new Logger().info('It seems we\\'re not running on Jupyter...', e);\n    }\n  }\n}\n\n// credits here: https://stackoverflow.com/questions/4810841/how-can-i-pretty-print-json-using-javascript#answer-7220510\nexport function syntaxHighlight(json) {\n  json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n  return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)/g, function(match) {\n    let cls = 'number';\n    if (/^\"/.test(match)) {\n      if (/:$/.test(match)) {\n        cls = 'key';\n      }\n      else {\n        cls = 'string';\n      }\n    }\n    else if (/true|false/.test(match)) {\n      cls = 'boolean';\n    }\n    else if (/null/.test(match)) {\n      cls = 'null';\n    }\n    return '<span class=\"' + cls + '\">' + match + '</span>';\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/component.js","import Renderer from './renderer';\nimport Tooltip from './tooltip';\n\n/* global d3 */\n\nexport default class Chart extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.axis = undefined;\n    this.yScale = undefined;\n    this.xScale = undefined;\n    this.datasets = undefined;\n    this.datasetNames = undefined;\n    this.tooltip = undefined;\n  }\n  \n  _initialize() {\n    this.tooltip = new Tooltip(this.options);\n    \n    this.element = this.parent.select('g.francy-content');\n    \n    this.axis = this.data.canvas.chart.axis;\n    this.datasets = this.data.canvas.chart.data;\n    this.datasetNames = Object.keys(this.datasets);\n\n    this.xScale = d3.scaleLinear().range([0, this.width]).domain(this.axis.x.domain);\n    this.yScale = d3.scaleLinear().range([this.height, 0]).domain(this.axis.y.domain);\n    \n    this.allValues = [];\n    this.datasetNames.forEach(key => this.allValues = this.allValues.concat(this.datasets[key]));\n\n    if (!this.axis.y.domain.length) {\n      this.yScale.domain([0, d3.max(this.allValues, d => d)]);\n    }\n\n    if (!this.axis.x.domain.length) {\n      this.xScale.domain([0, this.allValues.length / this.datasetNames.length]);\n    }\n  }\n  \n  _renderAxis() {\n    // force rebuild axis again\n    let xAxisGroup = this.element.selectAll('g.francy-x-axis');\n\n    if (!xAxisGroup.node()) {\n      xAxisGroup = this.element.append('g').attr('class', 'francy-x-axis');\n    }\n\n    xAxisGroup.selectAll('*').remove();\n\n    // add the x Axis\n    xAxisGroup\n      .attr('transform', `translate(0,${this.height})`)\n      .call(d3.axisBottom(this.xScale))\n      .append('text')\n      .attr('dy', 50)\n      .attr('dx', this.width / 2)\n      .attr('fill', 'black')\n      .attr('class', 'francy-axis')\n      .style('text-anchor', 'end')\n      .text(this.axis.x.title);\n\n    // force rebuild axis again\n    let yAxisGroup = this.element.selectAll('g.francy-y-axis');\n\n    if (!yAxisGroup.node()) {\n      yAxisGroup = this.element.append('g').attr('class', 'francy-y-axis');\n    }\n\n    yAxisGroup.selectAll('*').remove();\n\n    // add the y Axis\n    yAxisGroup\n      .call(d3.axisLeft(this.yScale))\n      .append('text')\n      .attr('dx', -50)\n      .attr('dy', this.height / 2)\n      .attr('fill', 'black')\n      .attr('class', 'francy-axis')\n      .style('text-anchor', 'end')\n      .text(this.axis.y.title);\n  }\n  \n  _renderLegend() {\n    if (this.data.canvas.chart.showLegend) {\n\n      let legendGroup = this.element.selectAll('.francy-legend');\n\n      if (!legendGroup.node()) {\n        legendGroup = this.element.append('g').attr('class', 'francy-legend');\n      }\n\n      // force rebuild legend again\n      legendGroup.selectAll('*').remove();\n\n      let legend = legendGroup.selectAll('g').data(this.datasetNames.slice());\n\n      legend.exit().remove();\n\n      legend = legend.enter()\n        .append('g')\n        .attr('transform', (d, i) => `translate(0,${i * 20})`)\n        .merge(legend);\n\n      legend.append('rect')\n        .attr('x', this.width + 20)\n        .attr('width', 19)\n        .attr('height', 19)\n        .style('fill', (d, i) => Chart.colors(i * 5));\n\n      legend.append('text')\n        .attr('x', this.width + 80)\n        .attr('y', 9)\n        .attr('dy', '.35em')\n        .style('text-anchor', 'end')\n        .text(d => d);\n    }\n  }\n\n  static tooltip(dataset, value) {\n    return { 'A': { 'title': 'Dataset', 'text': dataset }, 'B': { 'title': 'Value', 'text': value } };\n  }\n\n  static get colors() {\n    return d3.scaleSequential().domain([0, 100]).interpolator(d3.interpolateRainbow);\n  }\n\n  static domainRange(max) {\n    return Array.from(new Array(max), (_, i) => i).map(x => x);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart.js","import Renderer from './renderer';\n\nexport default class Composite extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    if (new.target === Composite) {\n      throw new TypeError('Cannot construct [Composite] instances directly!');\n    }\n    this.renderers = [];\n  }\n\n  add(renderer) {\n    this.renderers.push(renderer);\n    return this;\n  }\n\n  renderChildren() {\n    // update children rendering with a new parent!\n    let options = this.options;\n    options.appendTo = this;\n    // render other components\n    for (let renderer of this.renderers) {\n      renderer.settings(options).load(this.data).render();\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/composite.js","import Logger from '../util/logger';\nimport JsonUtils from '../util/json-utils';\n\nexport default class Base {\n\n  constructor({ verbose = false, appendTo = 'body', callbackHandler }) {\n    this.settings({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    /**\n     * @type {Logger} the logger for this class\n     */\n    this.log = new Logger(this.options);\n  }\n\n  settings({ verbose, appendTo, callbackHandler }) {\n    this.options = this.options || {};\n    if (!this.options.callbackHandler && !callbackHandler) {\n      throw new Error('A Callback Handler must be provided! This will be used to trigger events from the graphics produced...');\n    }\n    if (!this.options.appendTo && !appendTo) {\n      throw new Error('Missing an element or id to append the graphics to...!');\n    }\n    /**\n     * @typedef {Object} Options\n     * @property {Boolean} verbose prints extra log information to console.log, default false\n     * @property {Boolean} appendTo where the generated html/svg components will be attached to, default body\n     * @property {Function} callbackHandler this handler will be used to invoke actions from the menu, default console.log\n     */\n    this.options.verbose = verbose || this.options.verbose;\n    this.options.appendTo = appendTo || this.options.appendTo;\n    this.options.callbackHandler = callbackHandler || this.options.callbackHandler;\n    return this;\n  }\n\n  load(json, partial) {\n    let data = JsonUtils.parse(json, partial);\n    if (data) {\n      this.data = data;\n    }\n    return this;\n  }\n\n  get logger() {\n    return this.log;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/base.js","/**\n * This class provides a logger for the Francy application.\n */\nexport default class Logger {\n\n  /**\n   * Logger constructor\n   * @param verbose prints extra log information to console.log, defaults to false\n   */\n  constructor({ verbose = false } = {}) {\n    this.verbose = verbose;\n    this.console = console;\n  }\n\n  /**\n   * Creates a [DEBUG] entry in the console log\n   * @param message the message to print\n   */\n  debug(message) {\n    if (this.verbose) {\n      this.console.debug(Logger._format('DEBUG', message));\n    }\n  }\n\n  /**\n   * Creates a [INFO] entry in the console log\n   * @param message the message to print\n   */\n  info(message) {\n    this.console.info(Logger._format('INFO', message));\n  }\n\n  /**\n   * Creates a [ERROR] entry in the console log\n   * @param message the message to print\n   * @param error the error Object to attach to the message\n   */\n  error(message, error) {\n    this.console.error(Logger._format('ERROR', message), error);\n  }\n\n  /**\n   * Creates a [WARN] entry in the console log\n   * @param message the message to print\n   * @param error the error Object to attach to the message\n   */\n  warn(message, error) {\n    error = error || {};\n    this.console.error(Logger._format('WARN', message), error);\n  }\n\n  /**\n   * This is a private method that formats all log messages\n   * @param level the log level\n   * @param message the message to print\n   */\n  static _format(level, message) {\n    return `[${level}] - ${new Date().toISOString()} - ${message}`;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/logger.js","import Renderer from './renderer';\nimport ContextMenu from './menu-context';\nimport Tooltip from './tooltip';\nimport Callback from './callback';\n\n/* global d3 */\n\nexport default class Graph extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n  \n  _initialize() {\n    this.element = this.parent.select('g.francy-content');\n  }\n\n  _applyEvents(element) {\n    if (!element) return;\n\n    let tooltip = new Tooltip(this.options);\n    let contextMenu = new ContextMenu(this.options);\n    let callback = new Callback(this.options);\n\n    element\n      .on('contextmenu', function(d) {\n        d = d.data || d;\n        // default, build context menu\n        contextMenu.load(d, true).render();\n        // any callbacks will be handled here\n        executeCallback.call(this, d, 'contextmenu');\n      })\n      .on('click', function(d) {\n        d = d.data || d;\n        // any callbacks will be handled here\n        executeCallback.call(this, d, 'click');\n      })\n      .on('dblclick', function(d) {\n        d = d.data || d;\n        // any callbacks will be handled here\n        executeCallback.call(this, d, 'dblclick');\n      })\n      .on('mouseenter', d => {\n        d = d.data || d;\n        // default, show tooltip\n        tooltip.load(d.messages, true).render();\n      })\n      .on('mouseleave', () => {\n        // default, hide tooltip\n        tooltip.unrender();\n      });\n\n    function executeCallback(data, event) {\n      if (data.callbacks) {\n        Object.values(data.callbacks).forEach((cb) => {\n          // execute the ones that match the event!\n          cb.trigger === event && callback.load({ callback: cb }, true).execute();\n        });\n      }\n    }\n  }\n\n  static get colors() {\n    return d3.scaleSequential().domain([0, 100]).interpolator(d3.interpolateRainbow);\n  }\n\n  static getSymbol(type) {\n    \n    let element = undefined;\n    switch (type) {\n    case 'cross':\n      element = d3.symbolCross;\n      break;\n    case 'diamond':\n      element = d3.symbolDiamond;\n      break;\n    case 'square':\n      element = d3.symbolSquare;\n      break;\n    case 'triangle':\n      element = d3.symbolTriangle;\n      break;\n    case 'star':\n      element = d3.symbolStar;\n      break;\n    case 'wye':\n      element = d3.symbolWye;\n      break;\n    case 'circle':\n    default:\n      element = d3.symbolCircle;\n    }\n\n    return element;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph.js","import Renderer from './renderer';\nimport Callback from './callback';\n\nexport default class Menu extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  traverse(appendTo, menusIterator) {\n    while (menusIterator.hasNext()) {\n      let menuItem = menusIterator.next();\n      let entry = appendTo.append('li');\n      let action = entry.selectAll('a').data([menuItem]).enter().append('a').attr('title', menuItem.title).html(menuItem.title);\n      if (menuItem.callback && Object.values(menuItem.callback).length) {\n        action.on('click', (d) => new Callback(this.options).load(d, true).execute());\n      }\n      if (menuItem.menus && Object.values(menuItem.menus).length > 0) {\n        let content = entry.append('ul');\n        let subMenusIterator = this.iterator(Object.values(menuItem.menus));\n        this.traverse(content, subMenusIterator);\n      }\n    }\n  }\n\n  iterator(array) {\n    let nextIndex = 0;\n    return {\n      next: function() {\n        return this.hasNext() ? array[nextIndex++] : undefined;\n      },\n      hasNext: function() {\n        return nextIndex < array.length;\n      }\n    };\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/menu.js","import Base from './base';\nimport RequiredArgsModal from './modal-required';\nimport { requires } from '../util/data-decorator';\n\nexport default class CallbackHandler extends Base {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.callback = callbackHandler;\n  }\n\n  @requires('callback')\n  execute() {\n    if (Object.keys(this.data.callback.requiredArgs).length) {\n      let options = this.options;\n      options.callbackHandler = (callbackObj) => this._execute.call(this, callbackObj);\n      return new RequiredArgsModal(options).load(this.data, true).render();\n    }\n    \n    // Trigger is the expected command on GAP for this events!\n    this._execute(this.data.callback);\n    \n  }\n\n  _execute(calbackObj) {\n    this.callback(`Trigger(${JSON.stringify(JSON.stringify(calbackObj))});`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/callback.js","import Renderer from './renderer';\n\n/* global d3 */\n\nexport default class Modal extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.overlay = undefined;\n    this.holder = undefined;\n  }\n  \n  _initialize() {\n    // we want to overlay everything, hence 'body' must be used\n    this.overlay = d3.select('body').append('div').attr('class', 'francy-overlay');\n    this.holder = d3.select('body').append('div').attr('class', 'francy');\n  }\n  \n  unrender() {\n    this.overlay.remove();\n    this.element.remove();\n    this.holder.remove();\n    return false;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/modal.js","import Renderer from './renderer';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Tooltip extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires()\n  render() {\n\n    this.element = this.HTMLParent.select('div.francy-tooltip-holder');\n    // check if the window is already present\n    if (!this.element.node()) {\n      this.element = this.HTMLParent.append('div')\n        .attr('class', 'francy-tooltip-holder');\n    }\n\n    // check if it exists already\n    if (this.element.selectAll('*').node()) {\n      return;\n    }\n\n    let pos = d3.mouse(this.SVGParent.node());\n\n    // TODO fix always visible tooltip, fine until someone complains about :P\n    this.element.style('left', (pos[0] + 5) + 'px').style('top', (pos[1] - 5) + 'px');\n\n    let table = this.element.append('div').attr('class', 'francy-tooltip')\n      .append('div').attr('class', 'francy-table')\n      .append('div').attr('class', 'francy-table-body');\n    let self = this;\n    Object.keys(this.data).map(function(key) {\n      let row = table.append('div').attr('class', 'francy-table-row');\n      row.append('div').attr('class', 'francy-table-cell').text(self.data[key].title);\n      row.append('div').attr('class', 'francy-table-cell').text(self.data[key].text);\n    });\n\n    // show tooltip\n    this.element.style('display', 'block');\n\n    return this;\n  }\n\n  unrender() {\n    if (this.element) {\n      this.element.selectAll('*').remove();\n      this.element.style('display', null);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/tooltip.js","import Frame from './render/frame';\nimport Renderer from './render/renderer';\nimport { requires } from './util/data-decorator';\n\n/* global d3 */\n\nlet ALL_CANVAS = {};\n\n/**\n * Francy is the main entry point for the whole framework. By passing an input string/object to the {Francy.load} function,\n * Francy will handle the creation of that json as long it is a valid and understandable json object to Francy.\n *  \n * @access public\n * \n * @version 0.5.0\n * \n * @example\n * let francy = new Francy({verbose: true, appendTo: '#div-id', callbackHandler: console.log});\n * francy.load(json).render();\n */\nexport default class Francy extends Renderer {\n\n  /**\n   * Creates an instance of Francy with the following options:\n   * @typedef {Object} Options\n   * @property {Boolean} verbose prints extra log information to console.log, default false\n   * @property {Boolean} appendTo where the generated html/svg components will be attached to, default body\n   * @property {Function} callbackHandler this handler will be used to invoke actions from the menu, default console.log\n   */\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    if (!d3) {\n      throw new Error('D3 is not imported! Francy won\\'t work without it... please import D3 v4+.');\n    }\n  }\n\n  /**\n   * Main entry point. Calling render passing a json representation string will \n   * trigger the drawing of a json object.\n   * @returns {Object} the html element created\n   */\n  @requires('canvas')\n  render() {\n    let frame = new Frame(this.options).load(this.data).render();\n    ALL_CANVAS[this.data.canvas.id] = frame;\n    return frame.element.node();\n  }\n\n  static unrender(id) {\n    delete ALL_CANVAS[id];\n  }\n}\n\ntry {\n  exports.Francy = window.Francy = Francy;\n  // handle events on resize\n  let oldResize = window.onresize;\n  window.onresize = function() {\n    // zoom to fit all canvas on resize\n    Object.values(ALL_CANVAS).forEach(function(frame) {\n      frame.canvas.zoomToFit();\n    });\n    // call old resize function if any!\n    if (typeof oldResize === 'function') {\n      oldResize();\n    }\n  };\n}\ncatch (e) {\n  exports.Francy = Francy;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/francy.js","import Composite from './composite';\nimport Canvas from './canvas';\nimport MainMenu from './menu-main';\nimport Message from './message';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Frame extends Composite {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.canvas = new Canvas(this.options);\n    this.menu = new MainMenu(this.options);\n    this.messages = new Message(this.options);\n    this.add(this.messages).add(this.menu).add(this.canvas);\n  }\n\n  @requires('canvas')\n  render() {\n    let parent = d3.select(this.options.appendTo);\n\n    const frameId = `Frame-${this.data.canvas.id}`;\n    this.element = d3.select(`div#${frameId}`);\n    // check if the canvas is already present\n    if (!this.element.node()) {\n      // create a svg element detached from the DOM!\n      this.logger.debug(`Creating Frame [${frameId}]...`);\n      this.element = parent.append('div').attr('class', 'francy').attr('id', frameId);\n    }\n\n    // cannot continue if canvas is not present\n    if (!this.element.node()) {\n      throw new Error(`Oops, could not create frame with id [${frameId}]... Cannot proceed.`);\n    }\n\n    this.logger.debug(`Frame updated [${frameId}]...`);\n\n    this.renderChildren();\n\n    return this;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/frame.js","/**\n * This class contains methods to deal with JSON.\n */\nexport default class JsonUtils {\n\n  /**\n   * Parses an input nd checks whether this input is valid and returns a JSON object.\n   * @param input - the input to parse\n   * @param partial - if the input is not a complete Francy JSON Object, defaults to false\n   * @returns {json} - if the input is a valid JSON object, otherwise returns {undefined}\n   */\n  static parse(input, partial = false) {\n    if (!input) return;\n    input = typeof input !== 'string' ? JSON.stringify(input) : input;\n    input = input.replace(/[\\n\\r\\b\\\\]+|(gap>)/g, '');\n    let jsonRegex = /{(?:[^])*}/g;\n    let match = jsonRegex.exec(input);\n    if (match) {\n      input = match[0];\n      try {\n        let json = JSON.parse(input);\n        return json.mime === JsonUtils.MIME || partial ? json : undefined;\n      }\n      catch (e) {\n        /* eslint-disable no-console */\n        console.error(e);\n        /* eslint-enable no-console */\n      }\n    }\n  }\n\n  /**\n   * Returns a static string representing the mime type supported by this package\n   */\n  static get MIME() {\n    return 'application/vnd.francy+json';\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/json-utils.js","import Composite from './composite';\nimport GraphFactory from './graph-factory';\nimport ChartFactory from './chart-factory';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Canvas extends Composite {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n    this.graph = new GraphFactory(this.options);\n    this.chartFactory = new ChartFactory(this.options);\n    this.add(this.graph).add(this.chartFactory);\n  }\n\n  @requires('canvas')\n  render() {\n    let content;\n    let zoom = d3.zoom();\n    let self = this;\n\n    function updateZoom(translateX, translateY, scale) {\n      self.element.call(zoom.transform, d3.zoomIdentity.translate(translateX, translateY).scale(scale, scale));\n    }\n\n    function zoomed() {\n      content.attr('transform', d3.event.transform);\n    }\n\n    function stopped() {\n      if (d3.event.defaultPrevented) { d3.event.stopPropagation(); }\n    }\n\n    function zoomToFit() {\n      // only execute if enable, of course\n      if (self.data.canvas.zoomToFit) {\n        let bounds = content.node().getBBox();\n\n        let clientBounds = self.element.node().getBoundingClientRect(),\n          fullWidth = clientBounds.right - clientBounds.left,\n          fullHeight = clientBounds.bottom - clientBounds.top;\n\n        let width = +bounds.width,\n          height = +bounds.height;\n\n        if (width === 0 || height === 0) return;\n\n        let midX = bounds.x + width / 2,\n          midY = bounds.y + height / 2;\n\n        let scale = 0.9 / Math.max(width / fullWidth, height / fullHeight);\n        let translateX = fullWidth / 2 - scale * midX,\n          translateY = fullHeight / 2 - scale * midY;\n\n        content.transition()\n          .duration(self.transitionDuration)\n          .attr('transform', `translate(${translateX},${translateY})scale(${scale},${scale})`)\n          .on('end', () => updateZoom(translateX, translateY, scale));\n      }\n    }\n\n    const canvasId = `Canvas-${this.data.canvas.id}`;\n    this.element = d3.select(`svg#${canvasId}`);\n    // check if the canvas is already present\n    if (!this.element.node()) {\n      // create a svg element detached from the DOM!\n      this.logger.debug(`Creating Canvas [${canvasId}]...`);\n      this.element = this.parent.append('svg')\n        .attr('class', 'francy-canvas')\n        .attr('id', canvasId);\n    }\n\n    // cannot continue if canvas is not present\n    if (!this.element.node()) {\n      throw new Error(`Oops, could not create canvas with id [${canvasId}]... Cannot proceed.`);\n    }\n\n    this.element.attr('width', this.data.canvas.width).attr('height', this.data.canvas.height);\n\n    content = this.element.select('g.francy-content');\n\n    if (!content.node()) {\n      content = this.element.append('g').attr('class', 'francy-content');\n      zoom.on('zoom', zoomed);\n      // remove zoom on double click!\n      this.element.call(zoom).on('dblclick.zoom', null);\n    }\n\n    this.element.on('click', stopped, true);\n\n    this.element.zoomToFit = this.zoomToFit = zoomToFit;\n\n    this.logger.debug(`Canvas updated [${canvasId}]...`);\n\n    this.renderChildren();\n\n    setTimeout(() => {\n      zoomToFit();\n    }, this.transitionDuration);\n\n    return this;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/canvas.js","import Renderer from './renderer';\nimport TreeGraph from './graph-tree';\nimport GenericGraph from './graph-generic';\nimport { requires } from '../util/data-decorator';\n\nexport default class Graph extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('canvas.graph')\n  render() {\n\n    let element = undefined;\n    switch (this.data.canvas.graph.type) {\n    case 'tree':\n      element = new TreeGraph(this.options).load(this.data).render();\n      break;\n    default:\n      element = new GenericGraph(this.options).load(this.data).render();\n    }\n\n    return element;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph-factory.js","import Graph from './graph';\nimport { RegisterMathJax } from '../util/component';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class TreeGraph extends Graph {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n\n    let i = 0,\n      root;\n\n    root = d3.hierarchy(this.treeData, d => d.children);\n    root.x0 = this.height / 2;\n    root.y0 = 0;\n\n    // compute height based on the depth of the graph\n    let levelWidth = [1];\n    let childCount = function (level, n) {\n\n      if (n.children && n.children.length > 0) {\n        if (levelWidth.length <= level + 1) levelWidth.push(0);\n\n        levelWidth[level + 1] += n.children.length;\n        n.children.forEach(function (d) {\n          childCount(level + 1, d);\n        });\n      }\n    };\n    childCount(0, root);\n    let newHeight = d3.max(levelWidth) * 100;\n\n    let treemap = d3.tree().size([newHeight, this.width]);\n\n    if (this.data.canvas.graph.collapsed) {\n      root.children.forEach(collapse);\n    }\n\n    update.call(this, root);\n\n    function collapse(d) {\n      if (d.children) {\n        d._children = d.children;\n        d._children.forEach(collapse);\n        d.children = null;\n      }\n    }\n\n    function update(source) {\n      let treeData = treemap(root);\n\n      let nodes = treeData.descendants(),\n        links = treeData.descendants().slice(1);\n\n      nodes.forEach(d => d.y = d.depth * 180);\n\n      let linkGroup = this.element.selectAll('g.francy-links');\n\n      if (!linkGroup.node()) {\n        linkGroup = this.element.append('g').attr('class', 'francy-links');\n      }\n\n      let link = linkGroup.selectAll('path.francy-edge')\n        .data(links, d => d.id || (d.id = ++i));\n\n      let linkEnter = link.enter()\n        .append('path').attr('class', 'francy-edge')\n        .attr('d', () => {\n          let o = {x: source.x0, y: source.y0};\n          return diagonal(o, o);\n        });\n\n      linkEnter.merge(link)\n        .transition().duration(this.transitionDuration).attr('d', d => diagonal(d, d.parent));\n\n      link.exit().transition().duration(this.transitionDuration)\n        .attr('d', () => {\n          let o = {x: source.x, y: source.y};\n          return diagonal(o, o);\n        }).remove();\n\n      linkGroup.selectAll('path.francy-edge')\n        .style('fill', 'none')\n        .style('stroke', '#ccc')\n        .style('stroke-width', '1px');\n\n      nodes.forEach((d) => {\n        d.x0 = d.x;\n        d.y0 = d.y;\n      });\n\n      function diagonal(s, d) {\n        return `M ${s.y} ${s.x}\n            C ${(s.y + d.y) / 2} ${s.x},\n              ${(s.y + d.y) / 2} ${d.x},\n              ${d.y} ${d.x}`;\n      }\n\n      let nodeGroup = this.element.selectAll('g.francy-nodes');\n\n      if (!nodeGroup.node()) {\n        nodeGroup = this.element.append('g').attr('class', 'francy-nodes');\n      }\n\n      let node = nodeGroup.selectAll('g.francy-node')\n        .data(nodes, d => d.id || (d.id = ++i));\n\n      let nodeEnter = node.enter().append('g')\n        .attr('class', 'francy-node')\n        .attr('transform', () => `translate(${source.y0},${source.x0})`);\n\n      nodeEnter.append('path')\n        .attr('d', d3.symbol().type(d => Graph.getSymbol(d.data.type)).size(d => d.data.size * 100))\n        .attr('class', 'francy-symbol');\n\n      nodeEnter.append('text')\n        .attr('class', 'francy-label')\n        .text(d => d.data.title)\n        .attr('x',  function() {\n          let bound = this.getBBox();\n          return -(bound.width / 2);\n        })\n        .style('cursor', d => d.children || d._children ? 'pointer' : 'default');\n\n      let nodeUpdate = nodeEnter.merge(node);\n\n      nodeUpdate.transition()\n        .duration(this.transitionDuration)\n        .attr('transform', d => `translate(${d.y},${d.x})`);\n\n      node.exit().transition().duration(this.transitionDuration)\n        .attr('transform', () => `translate(${source.y},${source.x})`)\n        .remove();\n\n      nodeGroup.selectAll('path.francy-symbol')\n        .style('fill', d => d.children || d._children ? 'lightsteelblue' : Graph.colors(d.data.layer * 5))\n        .style('cursor', d => d.children || d._children ? 'pointer' : 'default');\n\n      node = nodeGroup.selectAll('g.francy-node');\n      \n      if (node.node()) {\n        this._applyEvents(node);\n\n        let nodeOnClick = node.on('click');\n        node.on('click', (d) => {\n        // any callbacks will be handled here\n          nodeOnClick.call(this, d.data);\n          // default, highlight connected nodes\n          click.call(this, d);\n        });\n      }\n\n      // Toggle children on click.\n      let self = this;\n\n      function click(d) {\n        if (d.children) {\n          d._children = d.children;\n          d.children = null;\n        }\n        else {\n          d.children = d._children;\n          d._children = null;\n        }\n        update.call(self, d);\n      }\n\n      RegisterMathJax(this.SVGParent);\n\n      setTimeout(() => {\n        this.parent.zoomToFit();\n      }, this.transitionDuration);\n    }\n\n    return this;\n\n  }\n\n  unrender() {}\n\n  /**\n   * Transforms flat data into tree data by analysing the parents of each node\n   * @returns {Object} the data transformed in tree data\n   */\n  get treeData() {\n    let canvasNodes = this.data.canvas.graph.nodes ? Object.values(this.data.canvas.graph.nodes) : [];\n    let dataMap = canvasNodes.reduce(function (map, node) {\n      map[node.id] = node;\n      return map;\n    }, {});\n    let treeData = [];\n    canvasNodes.forEach(function(node) {\n      let parent = dataMap[node.parent];\n      if (parent) {\n        (parent.children || (parent.children = [])).push(node);\n      }\n      else {\n        treeData.push(node);\n      }\n    });\n    return treeData[0];\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph-tree.js","import Menu from './menu';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class ContextMenu extends Menu {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('menus')\n  render() {\n\n    d3.event.preventDefault();\n\n    this.element = this.HTMLParent.select('div.francy-context-menu-holder');\n    // check if the window is already present\n    if (!this.element.node()) {\n      this.element = this.HTMLParent.append('div')\n        .attr('class', 'francy-context-menu-holder');\n    }\n\n    let pos = d3.mouse(this.SVGParent.node());\n\n    this.element.style('left', pos[0] + 5 + 'px').style('top', pos[1] + 5 + 'px');\n\n    // show the context menu\n    this.element.style('display', 'block');\n\n    // check if it exists already\n    if (this.element.selectAll('*').node()) {\n      return;\n    }\n\n    // destroy menu\n    d3.select('body').on('click.francy-context-menu', () => this.unrender());\n\n    // this gets executed when a contextmenu event occurs\n    let menu = this.element.append('div').attr('class', 'francy-context-menu').append('ul');\n    let menusIterator = this.iterator(Object.values(this.data.menus));\n    this.traverse(menu, menusIterator);\n\n    return this;\n  }\n\n  unrender() {\n    if (this.element) {\n      this.element.selectAll('*').remove();\n      this.element.style('display', null);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/menu-context.js","import Modal from './modal';\nimport { RegisterJupyterKeyboardEvents } from '../util/component';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class RequiredArgsModal extends Modal {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n    let self = this;\n\n    let modalId = this.data.callback.id;\n\n    this.logger.debug(`Creating Callback Modal [${modalId}]...`);\n\n    this.element = this.holder.append('div')\n      .attr('id', modalId)\n      .attr('class', 'francy-modal');\n\n    let form = this.element.append('form');\n\n    let header = form.append('div').attr('class', 'francy-modal-header');\n\n    let headerTitle = header.append('span').html('Required arguments&nbsp;');\n    if (this.data.title) {\n      headerTitle.append('span').attr('style', 'font-weight: bold;').text(`for ${this.data.title}`);\n    }\n\n    let content = form.append('div').attr('class', 'francy-modal-content').append('div').attr('class', 'francy-table').append('div').attr('class', 'francy-table-body');\n\n    for (let arg of Object.values(this.data.callback.requiredArgs)) {\n      let row = content.append('div').attr('class', 'francy-table-row');\n      row.append('div').attr('class', 'francy-table-cell').append('label').attr('for', arg.id).text(arg.title);\n      let input = row.append('div').attr('class', 'francy-table-cell').append('input').attr('id', arg.id).attr('class', 'francy-arg')\n        .attr('required', '')\n        .attr('name', arg.id)\n        .attr('type', arg.type)\n        .attr('value', arg.value)\n        .on('change', function () {\n          self.data.callback.requiredArgs[this.id].value = this.value;\n        })\n        .on('input', this.onchange)\n        .on('keyup', this.onchange)\n        .on('paste', this.onchange);\n      // wait, if it is boolean we create a checkbox\n      if (arg.type === 'boolean') {\n        // well, a checkbox works this way so we need to initialize \n        // the value to false and update the value based on the checked \n        // property that triggers the onchange event\n        arg.value = arg.value || false;\n        input.attr('type', 'checkbox').attr('required', null)\n          .attr('value', arg.value)\n          .on('change', function() { self.data.callback.requiredArgs[this.id].value = this.value = this.checked; });\n      }\n      row.append('span').attr('class', 'validity');\n    }\n\n    let footer = form.append('div').attr('class', 'francy-modal-footer');\n\n    footer.append('button').text('Ok').on('click', () => {\n      if (form.node().checkValidity()) {\n        d3.event.preventDefault();\n        this.options.callbackHandler(this.data.callback);\n        this.unrender.call(this);\n      }\n      return false;\n    });\n    footer.append('button').text('Cancel').on('click', () => { \n      d3.event.preventDefault(); \n      this.unrender.call(this); \n    });\n\n    // disable keyboard shortcuts when using this modal in Jupyter\n    RegisterJupyterKeyboardEvents(['.francy', '.francy-arg', '.francy-overlay', '.francy-modal']);\n\n    let inputElement = content.selectAll('.francy-arg').node();\n    if (inputElement) {\n      inputElement.focus();\n    }\n\n    this.logger.debug(`Callback Modal updated [${modalId}]...`);\n\n    return this;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/modal-required.js","import Graph from './graph';\nimport { RegisterMathJax } from '../util/component';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class GenericGraph extends Graph {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n    var self = this;\n    \n    let simulationActive = this.data.canvas.graph.simulation;\n\n    let canvasNodes = this.data.canvas.graph.nodes ? Object.values(this.data.canvas.graph.nodes) : [],\n      canvasLinks = this.data.canvas.graph.links ? Object.values(this.data.canvas.graph.links) : [];\n\n    let linkGroup = this.element.selectAll('g.francy-links');\n\n    if (!linkGroup.node()) {\n      linkGroup = this.element.append('g').attr('class', 'francy-links');\n    }\n\n    let links = linkGroup.selectAll('g.francy-link').data();\n    let linksToAdd = this._filterNewElements(canvasLinks, links);\n\n    let link = linkGroup.selectAll('g.francy-link').data(linksToAdd, d => d.id);\n\n    let nodeGroup = this.element.selectAll('g.francy-nodes');\n\n    if (!nodeGroup.node()) {\n      nodeGroup = this.element.append('g').attr('class', 'francy-nodes');\n    }\n\n    let nodes = nodeGroup.selectAll('g.francy-node').data();\n    let nodesToAdd = this._filterNewElements(canvasNodes, nodes);\n\n    let node = nodeGroup.selectAll('g.francy-node').data(nodesToAdd, d => d.id);\n\n    if (node.exit().data().length === 0 &&\n      node.enter().data().length === 0 &&\n      link.enter().data().length === 0 &&\n      link.exit().data().length === 0) {\n      return;\n    }\n\n    let linkEnter = link.enter().append('g').attr('class', 'francy-link');\n\n    linkEnter.append('line').attr('class', 'francy-edge');\n\n    link.exit().remove();\n\n    link = linkGroup.selectAll('g.francy-link line.francy-edge');\n\n    if (this.data.canvas.graph.type === 'directed') {\n      // this means we need arrows, so we append the marker\n      self.parent.append('defs').selectAll('marker')\n        .data(['arrow'])\n        .enter().append('marker')\n        .attr('class', 'francy-arrows')\n        .attr('id', d => d)\n        .attr('viewBox', '0 -5 10 10')\n        .attr('refX', 25)\n        .attr('refY', 0)\n        .attr('markerWidth', 10)\n        .attr('markerHeight', 10)\n        .attr('orient', 'auto')\n        .append('path')\n        .attr('d', 'M0,-5L10,0L0,5 L10,0 L0, -5');\n      // update the style of the link\n      link.style('marker-end', 'url(#arrow)');\n    }\n\n    let nodeEnter = node.enter().append('g')\n      .attr('class', 'francy-node').attr('id', d => d.id);\n\n    nodeEnter.append('path')\n      .attr('d', d3.symbol().type(d => Graph.getSymbol(d.type)).size(d => d.size * 100))\n      .style('fill', d => Graph.colors(d.layer * 5))\n      .attr('class', d => 'francy-symbol' + (d.highlight ? ' francy-highlight' : '') + (Object.values(d.menus).length ? ' francy-context' : ''));\n\n    nodeEnter.append('text')\n      .attr('class', 'francy-label')\n      .text(d => d.title)\n      .attr('x', function() {\n        let bound = this.getBBox();\n        return -(bound.width / 2);\n      });\n\n    node.exit().remove();\n\n    node = nodeGroup.selectAll('g.francy-node');\n\n    if (this.data.canvas.graph.drag) {\n      node.call(d3.drag()\n        .on('start', dragstarted)\n        .on('drag', dragged)\n        .on('end', dragended));\n    }\n\n    if (node && !node.empty()) {\n\n      this._applyEvents(node);\n\n      if (this.data.canvas.graph.showNeighbours) {\n        let nodeOnClick = node.on('click');\n        node.on('click', function(d) {\n          // default, highlight connected nodes\n          connectedNodes.call(this);\n          // any callbacks will be handled here\n          nodeOnClick.call(this, d);\n        });\n      }\n    }\n\n    if (simulationActive) {\n      //iterate through the data and recalculate its size\n      node.each(function(d){\n        let bound = this.getBBox();\n        return d.size = bound.width;\n      });\n      // Canvas Forces\n      let centerForce = d3.forceCenter().x(this.width / 2).y(this.height / 2);\n      let manyForce = d3.forceManyBody().strength(-canvasNodes.length * 50);\n      let linkForce = d3.forceLink(canvasLinks).id(d => d.id).distance(50);\n      let collideForce = d3.forceCollide().radius(d => d.size).iterations(3);\n\n      //Generic gravity for the X position\n      let forceX = d3.forceX(this.width / 2).strength(0.05);\n\n      //Generic gravity for the Y position - undirected/directed graphs fall here\n      let forceY = d3.forceY(-this.height / 2).strength(0.25);\n\n      if (this.data.canvas.graph.type === 'hasse') {\n        //Generic gravity for the X position\n        forceX = d3.forceX(this.width / 2).strength(0.3);\n        //Strong y positioning based on layer to simulate the hasse diagram\n        forceY = d3.forceY(d => d.layer * 75).strength(0.7);\n      }\n\n      var simulation = d3.forceSimulation().nodes(nodesToAdd)\n        .force('charge', manyForce)\n        .force('link', linkForce)\n        .force('center', centerForce)\n        .force('x', forceX)\n        .force('y', forceY)\n        .force('collide', collideForce)\n        .on('tick', ticked)\n        .on('end', function() {\n          // zoom to fit when simulation is over\n          self.parent.zoomToFit();\n        });\n\n      //force simulation restart\n      simulation.alpha(0.5).restart();\n    }\n    else {\n      // well, simulation is off, apply fixed positions and zoom to fit now\n      ticked();\n      self.parent.zoomToFit();\n    }\n\n    function ticked() {\n      link\n        .attr('x1', d => d.source.x)\n        .attr('y1', d => d.source.y)\n        .attr('x2', d => d.target.x)\n        .attr('y2', d => d.target.y);\n\n      node.attr('transform', d => `translate(${d.x},${d.y})`);\n    }\n\n    // HIGHLIGHT\n    //Toggle stores whether the highlighting is on\n    let toggle = 0;\n    //Create an array logging what is connected to what\n    let linkedByIndex = {};\n\n    for (let i = 0; i < canvasNodes.length; i++) {\n      linkedByIndex[`${i},${i}`] = 1;\n    }\n\n    canvasLinks.forEach(function(d) {\n      linkedByIndex[`${d.source.index},${d.target.index}`] = 1;\n    });\n\n    function connectedNodes() {\n      //This function looks up whether a pair are neighbours\n      function neighboring(a, b) {\n        return linkedByIndex[`${a.index},${b.index}`];\n      }\n      d3.event.preventDefault();\n      if (toggle === 0) {\n        //Reduce the opacity of all but the neighbouring nodes\n        let d = d3.select(this).node().__data__;\n        node.style('opacity', o => neighboring(d, o) || neighboring(o, d) ? 1 : 0.1);\n        link.style('opacity', o => d.index === o.source.index || d.index === o.target.index ? 1 : 0.1);\n        //Reduce the op\n        toggle = 1;\n      }\n      else {\n        //Put them back to opacity=1\n        node.style('opacity', 1);\n        link.style('opacity', 1);\n        toggle = 0;\n      }\n    }\n\n    function dragstarted(d) {\n      if (!d3.event.active && simulationActive) {\n        simulation.alphaTarget(0.01).restart();\n      }\n      d.fx = d.x;\n      d.fy = d.y;\n    }\n\n    function dragged(d) {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    }\n\n    function dragended(d) {\n      if (!d3.event.active && simulationActive) {\n        simulation.alphaTarget(0);\n      }\n      d.fx = null;\n      d.fy = null;\n    }\n\n    RegisterMathJax(this.SVGParent);\n\n    return this;\n\n  }\n\n  unrender() {}\n  \n  _filterNewElements(canvasObjects, d3Element) {\n    let newElements = [];\n    canvasObjects.forEach(o => {\n      let link = d3Element.find(d => d.id === o.id);\n      if (link) {\n        newElements.push(link);\n      }\n      else {\n        newElements.push(o);\n      }\n    });\n    return newElements;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/graph-generic.js","import Renderer from './renderer';\nimport BarChart from './chart-bar';\nimport LineChart from './chart-line';\nimport ScatterChart from './chart-scatter';\nimport { requires } from '../util/data-decorator';\n\nexport default class ChartFactory extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('canvas.chart')\n  render() {\n    \n    let element = undefined;\n    switch (this.data.canvas.chart.type) {\n    case 'bar':\n      element = new BarChart(this.options).load(this.data).render();\n      break;\n    case 'line':\n      element = new LineChart(this.options).load(this.data).render();\n      break;\n    case 'scatter':\n      element = new ScatterChart(this.options).load(this.data).render();\n      break;\n    }\n\n    return element;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-factory.js","import Chart from './chart';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class BarChart extends Chart {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n    \n    this.xScale = d3.scaleBand().range([0, this.width]).padding(0.1).domain(this.axis.x.domain);\n\n    if (!this.axis.x.domain.length) {\n      this.axis.x.domain = Chart.domainRange(this.allValues.length / this.datasetNames.length);\n      this.xScale.domain(this.axis.x.domain);\n    }\n\n    let barsGroup = this.element.selectAll('g.francy-bars');\n\n    if (!barsGroup.node()) {\n      barsGroup = this.element.append('g').attr('class', 'francy-bars');\n    }\n\n    var self = this;\n    \n    this.datasetNames.forEach(function(key, index) {\n      let bar = barsGroup.selectAll(`.francy-bar-${index}`).data(self.datasets[key]);\n\n      bar.exit().transition().duration(750)\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      // append the rectangles for the bar chart\n      let barEnter = bar.enter()\n        .append('rect')\n        .style('fill', () => Chart.colors(index * 5))\n        .attr('class', `francy-bar-${index}`)\n        .attr('x', function(d, i) {\n          return self.xScale(self.axis.x.domain[i]) + index * (self.xScale.bandwidth() / self.datasetNames.length);\n        })\n        .attr('width', (self.xScale.bandwidth() / self.datasetNames.length) - 1)\n        .attr('y', function(d) {\n          return self.yScale(d);\n        })\n        .attr('height', function(d) {\n          return self.height - self.yScale(d);\n        })\n        .on('mouseenter', function(d) {\n          d3.select(this).transition()\n            .duration(250).style('fill-opacity', 0.5);\n          self.tooltip.load(Chart.tooltip(key, d), true).render();\n        })\n        .on('mouseleave', function() {\n          d3.select(this).transition()\n            .duration(250).style('fill-opacity', 1);\n          self.tooltip.unrender();\n        });\n\n      barEnter.merge(bar)\n        .attr('x', function(d, i) { return self.xScale(self.axis.x.domain[i]) + index * (self.xScale.bandwidth() / self.datasetNames.length); })\n        .attr('width', (self.xScale.bandwidth() / self.datasetNames.length) - 1)\n        .attr('y', function(d) { return self.yScale(d); })\n        .attr('height', function(d) { return self.height - self.yScale(d); });\n    });\n\n    this._renderAxis();\n    this._renderLegend();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-bar.js","import Chart from './chart';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class LineChart extends Chart {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n    \n    let linesGroup = this.element.selectAll('g.francy-lines');\n\n    if (!linesGroup.node()) {\n      linesGroup = this.element.append('g').attr('class', 'francy-lines');\n    }\n\n    var self = this;\n    \n    this.datasetNames.forEach(function(key, index) {\n      let valueLine = d3.line()\n        .x(function(d, i) {\n          return self.xScale(i);\n        })\n        .y(function(d) {\n          return self.yScale(d);\n        });\n\n      let line = linesGroup.selectAll(`.francy-line-${index}`).data([self.datasets[key]]);\n\n      line.exit().transition().duration(750)\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      // append the rectangles for the bar chart\n      let lineEnter = line.enter()\n        .append('path')\n        .style('stroke', () => Chart.colors(index * 5))\n        .style('stroke-width', '5px')\n        .attr('class', `francy-line-${index}`)\n        .attr('d', valueLine)\n        .on('mouseenter', function(d) {\n          d3.select(this).transition()\n            .duration(250)\n            .style('stroke-opacity', 0.5)\n            .style('stroke-width', '10px');\n          self.tooltip.load(Chart.tooltip(key, d), true).render();\n        })\n        .on('mouseleave', function() {\n          d3.select(this).transition()\n            .duration(250)\n            .style('stroke-opacity', 1)\n            .style('stroke-width', '5px');\n          self.tooltip.unrender();\n        });\n\n      lineEnter.merge(line);\n    });\n\n    this._renderAxis();\n    this._renderLegend();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-line.js","import Chart from './chart';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class ScatterChart extends Chart {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n\n    let scatterGroup = this.element.selectAll('g.francy-scatters');\n\n    if (!scatterGroup.node()) {\n      scatterGroup = this.element.append('g').attr('class', 'francy-scatters');\n    }\n    \n    let self = this;\n\n    this.datasetNames.forEach(function(key, index) {\n      let scatter = scatterGroup.selectAll(`.francy-scatter-${index}`).data(self.datasets[key]);\n\n      scatter.exit().transition().duration(750)\n        .style('fill-opacity', 1e-6)\n        .remove();\n\n      // append the rectangles for the bar chart\n      let scatterEnter = scatter\n        .enter()\n        .append('circle')\n        .style('fill', () => Chart.colors(index * 5))\n        .attr('class', `francy-scatter-${index}`)\n        .attr('r', 5)\n        .attr('cx', function(d, i) {\n          return self.xScale(i);\n        })\n        .attr('cy', function(d) {\n          return self.yScale(d);\n        })\n        .on('mouseenter', function(d) {\n          d3.select(this).transition()\n            .duration(250)\n            .style('fill-opacity', 0.5)\n            .attr('r', 10);\n          self.tooltip.load(Chart.tooltip(key, d), true).render();\n        })\n        .on('mouseleave', function() {\n          d3.select(this).transition()\n            .duration(250)\n            .style('fill-opacity', 1)\n            .attr('r', 5);\n          self.tooltip.unrender();\n        });\n\n      scatterEnter.merge(scatter);\n    });\n\n    this._renderAxis();\n\n    this._renderLegend();\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/chart-scatter.js","import Menu from './menu';\nimport AboutModal from './modal-about';\nimport * as SvgToPng from '../../node_modules/save-svg-as-png/saveSvgAsPng';\n\n/* global d3 window */\n\nexport default class MainMenu extends Menu {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  render() {\n    let aboutModal = new AboutModal(this.options);\n\n    // Otherwise clashes with the canvas itself!\n    const menuId = `MainMenu-${this.data.canvas.id}`;\n    this.element = d3.select(`#${menuId}`);\n\n    // Check if the menu is already present\n    if (!this.element.node()) {\n      // create a div element detached from the DOM!\n      this.logger.debug(`Creating Main Menu [${menuId}]...`);\n      this.element = this.parent.append('div').attr('class', 'francy-main-menu-holder').attr('id', menuId);\n    }\n\n    // Force rebuild menu again\n    this.element.selectAll('*').remove();\n\n    this.element = this.element.append('ul').attr('class', 'francy-main-menu');\n\n    if (this.data.canvas.title) {\n      this.element.append('li').attr('class', 'francy-title').append('a').html(this.data.canvas.title);\n    }\n\n    let entry = this.element.append('li');\n    entry.append('a').html('Francy');\n    let content = entry.append('ul');\n    content.append('li').append('a').on('click', () => this.options.appendTo.canvas.zoomToFit()).attr('title', 'Zoom to Fit').html('Zoom to Fit');\n    content.append('li').append('a').on('click', () => SvgToPng.saveSvgAsPng(this.SVGParent.node(), 'diagram.png')).attr('title', 'Save to PNG').html('Save to PNG');\n    content.append('li').append('a').on('click', () => aboutModal.load(this.data).render()).attr('title', 'About').html('About');\n\n    // Traverse all menus and flatten them!\n    let menusIterator = this.iterator(Object.values(this.data.canvas.menus));\n    this.traverse(this.element, menusIterator);\n\n    this.logger.debug(`Main Menu updated [${menuId}]...`);\n\n    return this;\n  }\n\n  unrender() {}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/menu-main.js","import Modal from './modal';\nimport { RegisterJupyterKeyboardEvents, syntaxHighlight } from '../util/component';\nimport { initialize } from '../util/initialize-decorator';\n\n/* global d3 */\n\nexport default class AboutModal extends Modal {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @initialize()\n  render() {\n\n    let modalId = 'AboutModalWindow';\n\n    this.logger.debug(`Creating About Modal [${modalId}]...`);\n\n    this.element = this.holder.append('div')\n      .attr('id', modalId)\n      .attr('class', 'francy-modal');\n\n    let form = this.element.append('form');\n\n    let header = form.append('div').attr('class', 'francy-modal-header');\n\n    header.append('span').html(`About Francy v${this.data.version || 'N/A'}`);\n\n    let content = form.append('div').attr('class', 'francy-modal-content')\n      .append('div').attr('class', 'francy-table')\n      .append('div').attr('class', 'francy-table-body');\n\n    content.append('span').text('Loaded Object:');\n    content.append('pre').attr('class', 'francy').html(syntaxHighlight(JSON.stringify(this.data.canvas, null, 2)));\n    content.append('span').append('a').attr('href', 'https://github.com/mcmartins/francy').text('Francy on Github');\n\n    let footer = form.append('div').attr('class', 'francy-modal-footer');\n\n    footer.append('button').text('Ok').on('click', () => { \n      d3.event.preventDefault(); \n      this.unrender.call(this); \n    });\n\n    // disable keyboard shortcuts when using this modal in Jupyter\n    RegisterJupyterKeyboardEvents(['.francy', '.francy-arg', '.francy-overlay', '.francy-modal']);\n\n    this.logger.debug(`Callback About updated [${modalId}]...`);\n\n    return this;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/modal-about.js","(function() {\n  var out$ = typeof exports != 'undefined' && exports || typeof define != 'undefined' && {} || this;\n\n  var doctype = '<?xml version=\"1.0\" standalone=\"no\"?><!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\" [<!ENTITY nbsp \"&#160;\">]>';\n\n  function isElement(obj) {\n    return obj instanceof HTMLElement || obj instanceof SVGElement;\n  }\n\n  function requireDomNode(el) {\n    if (!isElement(el)) {\n      throw new Error('an HTMLElement or SVGElement is required; got ' + el);\n    }\n  }\n\n  function isExternal(url) {\n    return url && url.lastIndexOf('http',0) == 0 && url.lastIndexOf(window.location.host) == -1;\n  }\n\n  function inlineImages(el, callback) {\n    requireDomNode(el);\n\n    var images = el.querySelectorAll('image'),\n        left = images.length,\n        checkDone = function() {\n          if (left === 0) {\n            callback();\n          }\n        };\n\n    checkDone();\n    for (var i = 0; i < images.length; i++) {\n      (function(image) {\n        var href = image.getAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\");\n        if (href) {\n          if (isExternal(href.value)) {\n            console.warn(\"Cannot render embedded images linking to external hosts: \"+href.value);\n            return;\n          }\n        }\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        var img = new Image();\n        img.crossOrigin=\"anonymous\";\n        href = href || image.getAttribute('href');\n        if (href) {\n          img.src = href;\n          img.onload = function() {\n            canvas.width = img.width;\n            canvas.height = img.height;\n            ctx.drawImage(img, 0, 0);\n            image.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", canvas.toDataURL('image/png'));\n            left--;\n            checkDone();\n          }\n          img.onerror = function() {\n            console.log(\"Could not load \"+href);\n            left--;\n            checkDone();\n          }\n        } else {\n          left--;\n          checkDone();\n        }\n      })(images[i]);\n    }\n  }\n\n  function styles(el, options, cssLoadedCallback) {\n    var selectorRemap = options.selectorRemap;\n    var modifyStyle = options.modifyStyle;\n    var css = \"\";\n    // each font that has extranl link is saved into queue, and processed\n    // asynchronously\n    var fontsQueue = [];\n    var sheets = document.styleSheets;\n    for (var i = 0; i < sheets.length; i++) {\n      try {\n        var rules = sheets[i].cssRules;\n      } catch (e) {\n        console.warn(\"Stylesheet could not be loaded: \"+sheets[i].href);\n        continue;\n      }\n\n      if (rules != null) {\n        for (var j = 0, match; j < rules.length; j++, match = null) {\n          var rule = rules[j];\n          if (typeof(rule.style) != \"undefined\") {\n            var selectorText;\n\n            try {\n              selectorText = rule.selectorText;\n            } catch(err) {\n              console.warn('The following CSS rule has an invalid selector: \"' + rule + '\"', err);\n            }\n\n            try {\n              if (selectorText) {\n                match = el.querySelector(selectorText) || el.parentNode.querySelector(selectorText);\n              }\n            } catch(err) {\n              console.warn('Invalid CSS selector \"' + selectorText + '\"', err);\n            }\n\n            if (match) {\n              var selector = selectorRemap ? selectorRemap(rule.selectorText) : rule.selectorText;\n              var cssText = modifyStyle ? modifyStyle(rule.style.cssText) : rule.style.cssText;\n              css += selector + \" { \" + cssText + \" }\\n\";\n            } else if(rule.cssText.match(/^@font-face/)) {\n              // below we are trying to find matches to external link. E.g.\n              // @font-face {\n              //   // ...\n              //   src: local('Abel'), url(https://fonts.gstatic.com/s/abel/v6/UzN-iejR1VoXU2Oc-7LsbvesZW2xOQ-xsNqO47m55DA.woff2);\n              // }\n              //\n              // This regex will save extrnal link into first capture group\n              var fontUrlRegexp = /url\\([\"']?(.+?)[\"']?\\)/;\n              // TODO: This needs to be changed to support multiple url declarations per font.\n              var fontUrlMatch = rule.cssText.match(fontUrlRegexp);\n\n              var externalFontUrl = (fontUrlMatch && fontUrlMatch[1]) || '';\n              var fontUrlIsDataURI = externalFontUrl.match(/^data:/);\n              if (fontUrlIsDataURI) {\n                // We should ignore data uri - they are already embedded\n                externalFontUrl = '';\n              }\n\n              if (externalFontUrl) {\n                // okay, we are lucky. We can fetch this font later\n\n                //handle url if relative\n                if (externalFontUrl.startsWith('../')) {\n                  externalFontUrl = sheets[i].href + '/../' + externalFontUrl\n                } else if (externalFontUrl.startsWith('./')) {\n                  externalFontUrl = sheets[i].href + '/.' + externalFontUrl\n                }\n\n                fontsQueue.push({\n                  text: rule.cssText,\n                  // Pass url regex, so that once font is downladed, we can run `replace()` on it\n                  fontUrlRegexp: fontUrlRegexp,\n                  format: getFontMimeTypeFromUrl(externalFontUrl),\n                  url: externalFontUrl\n                });\n              } else {\n                // otherwise, use previous logic\n                css += rule.cssText + '\\n';\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // Now all css is processed, it's time to handle scheduled fonts\n    processFontQueue(fontsQueue);\n\n    function getFontMimeTypeFromUrl(fontUrl) {\n      var supportedFormats = {\n        'woff2': 'font/woff2',\n        'woff': 'font/woff',\n        'otf': 'application/x-font-opentype',\n        'ttf': 'application/x-font-ttf',\n        'eot': 'application/vnd.ms-fontobject',\n        'sfnt': 'application/font-sfnt',\n        'svg': 'image/svg+xml'\n      };\n      var extensions = Object.keys(supportedFormats);\n      for (var i = 0; i < extensions.length; ++i) {\n        var extension = extensions[i];\n        // TODO: This is not bullet proof, it needs to handle edge cases...\n        if (fontUrl.indexOf('.' + extension) > 0) {\n          return supportedFormats[extension];\n        }\n      }\n\n      // If you see this error message, you probably need to update code above.\n      console.error('Unknown font format for ' + fontUrl+ '; Fonts may not be working correctly');\n      return 'application/octet-stream';\n    }\n\n    function processFontQueue(queue) {\n      if (queue.length > 0) {\n        // load fonts one by one until we have anything in the queue:\n        var font = queue.pop();\n        processNext(font);\n      } else {\n        // no more fonts to load.\n        cssLoadedCallback(css);\n      }\n\n      function processNext(font) {\n        // TODO: This could benefit from caching.\n        var oReq = new XMLHttpRequest();\n        oReq.addEventListener('load', fontLoaded);\n        oReq.addEventListener('error', transferFailed);\n        oReq.addEventListener('abort', transferFailed);\n        oReq.open('GET', font.url);\n        oReq.responseType = 'arraybuffer';\n        oReq.send();\n\n        function fontLoaded() {\n          // TODO: it may be also worth to wait until fonts are fully loaded before\n          // attempting to rasterize them. (e.g. use https://developer.mozilla.org/en-US/docs/Web/API/FontFaceSet )\n          var fontBits = oReq.response;\n          var fontInBase64 = arrayBufferToBase64(fontBits);\n          updateFontStyle(font, fontInBase64);\n        }\n\n        function transferFailed(e) {\n          console.warn('Failed to load font from: ' + font.url);\n          console.warn(e)\n          css += font.text + '\\n';\n          processFontQueue();\n        }\n\n        function updateFontStyle(font, fontInBase64) {\n          var dataUrl = 'url(\"data:' + font.format + ';base64,' + fontInBase64 + '\")';\n          css += font.text.replace(font.fontUrlRegexp, dataUrl) + '\\n';\n\n          // schedule next font download on next tick.\n          setTimeout(function() {\n            processFontQueue(queue)\n          }, 0);\n        }\n\n      }\n    }\n\n    function arrayBufferToBase64(buffer) {\n      var binary = '';\n      var bytes = new Uint8Array(buffer);\n      var len = bytes.byteLength;\n\n      for (var i = 0; i < len; i++) {\n          binary += String.fromCharCode(bytes[i]);\n      }\n\n      return window.btoa(binary);\n    }\n  }\n\n  function getDimension(el, clone, dim) {\n    var v = (el.viewBox && el.viewBox.baseVal && el.viewBox.baseVal[dim]) ||\n      (clone.getAttribute(dim) !== null && !clone.getAttribute(dim).match(/%$/) && parseInt(clone.getAttribute(dim))) ||\n      el.getBoundingClientRect()[dim] ||\n      parseInt(clone.style[dim]) ||\n      parseInt(window.getComputedStyle(el).getPropertyValue(dim));\n    return (typeof v === 'undefined' || v === null || isNaN(parseFloat(v))) ? 0 : v;\n  }\n\n  function reEncode(data) {\n    data = encodeURIComponent(data);\n    data = data.replace(/%([0-9A-F]{2})/g, function(match, p1) {\n      var c = String.fromCharCode('0x'+p1);\n      return c === '%' ? '%25' : c;\n    });\n    return decodeURIComponent(data);\n  }\n\n  out$.prepareSvg = function(el, options, cb) {\n    requireDomNode(el);\n\n    options = options || {};\n    options.scale = options.scale || 1;\n    options.responsive = options.responsive || false;\n    var xmlns = \"http://www.w3.org/2000/xmlns/\";\n\n    inlineImages(el, function() {\n      var outer = document.createElement(\"div\");\n      var clone = el.cloneNode(true);\n      var width, height;\n      if(el.tagName == 'svg') {\n        width = options.width || getDimension(el, clone, 'width');\n        height = options.height || getDimension(el, clone, 'height');\n      } else if(el.getBBox) {\n        var box = el.getBBox();\n        width = box.x + box.width;\n        height = box.y + box.height;\n        clone.setAttribute('transform', clone.getAttribute('transform').replace(/translate\\(.*?\\)/, ''));\n\n        var svg = document.createElementNS('http://www.w3.org/2000/svg','svg')\n        svg.appendChild(clone)\n        clone = svg;\n      } else {\n        console.error('Attempted to render non-SVG element', el);\n        return;\n      }\n\n      clone.setAttribute(\"version\", \"1.1\");\n      if (!clone.getAttribute('xmlns')) {\n        clone.setAttributeNS(xmlns, \"xmlns\", \"http://www.w3.org/2000/svg\");\n      }\n      if (!clone.getAttribute('xmlns:xlink')) {\n        clone.setAttributeNS(xmlns, \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n      }\n\n      if (options.responsive) {\n        clone.removeAttribute('width');\n        clone.removeAttribute('height');\n        clone.setAttribute('preserveAspectRatio', 'xMinYMin meet');\n      } else {\n        clone.setAttribute(\"width\", width * options.scale);\n        clone.setAttribute(\"height\", height * options.scale);\n      }\n\n      clone.setAttribute(\"viewBox\", [\n        options.left || 0,\n        options.top || 0,\n        width,\n        height\n      ].join(\" \"));\n\n      var fos = clone.querySelectorAll('foreignObject > *');\n      for (var i = 0; i < fos.length; i++) {\n        if (!fos[i].getAttribute('xmlns')) {\n          fos[i].setAttributeNS(xmlns, \"xmlns\", \"http://www.w3.org/1999/xhtml\");\n        }\n      }\n\n      outer.appendChild(clone);\n\n      // In case of custom fonts we need to fetch font first, and then inline\n      // its url into data-uri format (encode as base64). That's why style\n      // processing is done asynchonously. Once all inlining is finshed\n      // cssLoadedCallback() is called.\n      styles(el, options, cssLoadedCallback);\n\n      function cssLoadedCallback(css) {\n        // here all fonts are inlined, so that we can render them properly.\n        var s = document.createElement('style');\n        s.setAttribute('type', 'text/css');\n        s.innerHTML = \"<![CDATA[\\n\" + css + \"\\n]]>\";\n        var defs = document.createElement('defs');\n        defs.appendChild(s);\n        clone.insertBefore(defs, clone.firstChild);\n\n        if (cb) {\n          var outHtml = outer.innerHTML;\n          outHtml = outHtml.replace(/NS\\d+:href/gi, 'xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href');\n          cb(outHtml, width, height);\n        }\n      }\n    });\n  }\n\n  out$.svgAsDataUri = function(el, options, cb) {\n    out$.prepareSvg(el, options, function(svg) {\n      var uri = 'data:image/svg+xml;base64,' + window.btoa(reEncode(doctype + svg));\n      if (cb) {\n        cb(uri);\n      }\n    });\n  }\n\n  out$.svgAsPngUri = function(el, options, cb) {\n    requireDomNode(el);\n\n    options = options || {};\n    options.encoderType = options.encoderType || 'image/png';\n    options.encoderOptions = options.encoderOptions || 0.8;\n\n    var convertToPng = function(src, w, h) {\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      canvas.width = w;\n      canvas.height = h;\n\n      if(options.canvg) {\n        options.canvg(canvas, src);\n      } else {\n        context.drawImage(src, 0, 0);\n      }\n\n      if(options.backgroundColor){\n        context.globalCompositeOperation = 'destination-over';\n        context.fillStyle = options.backgroundColor;\n        context.fillRect(0, 0, canvas.width, canvas.height);\n      }\n\n      var png;\n      try {\n        png = canvas.toDataURL(options.encoderType, options.encoderOptions);\n      } catch (e) {\n        if ((typeof SecurityError !== 'undefined' && e instanceof SecurityError) || e.name == \"SecurityError\") {\n          console.error(\"Rendered SVG images cannot be downloaded in this browser.\");\n          return;\n        } else {\n          throw e;\n        }\n      }\n      cb(png);\n    }\n\n    if(options.canvg) {\n      out$.prepareSvg(el, options, convertToPng);\n    } else {\n      out$.svgAsDataUri(el, options, function(uri) {\n        var image = new Image();\n\n        image.onload = function() {\n          convertToPng(image, image.width, image.height);\n        }\n\n        image.onerror = function() {\n          console.error(\n            'There was an error loading the data URI as an image on the following SVG\\n',\n            window.atob(uri.slice(26)), '\\n',\n            \"Open the following link to see browser's diagnosis\\n\",\n            uri);\n        }\n\n        image.src = uri;\n      });\n    }\n  }\n\n  out$.download = function(name, uri) {\n    if (navigator.msSaveOrOpenBlob) {\n      navigator.msSaveOrOpenBlob(uriToBlob(uri), name);\n    } else {\n      var saveLink = document.createElement('a');\n      var downloadSupported = 'download' in saveLink;\n      if (downloadSupported) {\n        saveLink.download = name;\n        saveLink.style.display = 'none';\n        document.body.appendChild(saveLink);\n        try {\n          var blob = uriToBlob(uri);\n          var url = URL.createObjectURL(blob);\n          saveLink.href = url;\n          saveLink.onclick = function() {\n            requestAnimationFrame(function() {\n              URL.revokeObjectURL(url);\n            })\n          };\n        } catch (e) {\n          console.warn('This browser does not support object URLs. Falling back to string URL.');\n          saveLink.href = uri;\n        }\n        saveLink.click();\n        document.body.removeChild(saveLink);\n      }\n      else {\n        window.open(uri, '_temp', 'menubar=no,toolbar=no,status=no');\n      }\n    }\n  }\n\n  function uriToBlob(uri) {\n    var byteString = window.atob(uri.split(',')[1]);\n    var mimeString = uri.split(',')[0].split(':')[1].split(';')[0]\n    var buffer = new ArrayBuffer(byteString.length);\n    var intArray = new Uint8Array(buffer);\n    for (var i = 0; i < byteString.length; i++) {\n      intArray[i] = byteString.charCodeAt(i);\n    }\n    return new Blob([buffer], {type: mimeString});\n  }\n\n  out$.saveSvg = function(el, name, options) {\n    requireDomNode(el);\n\n    options = options || {};\n    out$.svgAsDataUri(el, options, function(uri) {\n      out$.download(name, uri);\n    });\n  }\n\n  out$.saveSvgAsPng = function(el, name, options) {\n    requireDomNode(el);\n\n    options = options || {};\n    out$.svgAsPngUri(el, options, function(uri) {\n      out$.download(name, uri);\n    });\n  }\n\n  // if define is defined create as an AMD module\n  if (typeof define !== 'undefined') {\n    define(function() {\n      return out$;\n    });\n  }\n\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/save-svg-as-png/saveSvgAsPng.js","import Renderer from './renderer';\nimport { requires } from '../util/data-decorator';\n\n/* global d3 */\n\nexport default class Message extends Renderer {\n\n  constructor({ verbose = false, appendTo, callbackHandler }) {\n    super({ verbose: verbose, appendTo: appendTo, callbackHandler: callbackHandler });\n  }\n\n  @requires('canvas.messages')\n  render() {\n\n    let messages = Object.keys(this.data.canvas.messages).map((key) => {\n      return {\n        id: key,\n        type: this.data.canvas.messages[key].type,\n        title: this.data.canvas.messages[key].title,\n        text: this.data.canvas.messages[key].text\n      };\n    });\n\n    let alertsId = `Messages-${this.data.canvas.id}`;\n    this.element = d3.select(`#${alertsId}`);\n    // check if the div is already present\n    if (!this.element.node()) {\n      this.element = this.parent.append('div').attr('class', 'francy-message-holder').attr('id', alertsId);\n    }\n\n    let message = this.element.selectAll('div.francy-alert').data(messages, d => d.id);\n    let messageEnter = message.enter().append('div').attr('id', d => d.id)\n      .attr('class', d => `francy-alert alert-${d.type}`).on('click', function() {\n        d3.select(this).style('display', 'none');\n      });\n    messageEnter.append('span').attr('class', 'strong').text(d => d.title);\n    messageEnter.append('span').text(d => d.text);\n    messageEnter.append('span').attr('class', 'strong').style('display', 'none').text('x');\n\n    messageEnter.merge(message);\n\n    message.exit().remove();\n\n    this.element.style('display', 'block');\n\n    return this;\n  }\n\n  unrender() {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/render/message.js"],"sourceRoot":""}